---
- name: Cisco IOS config
  hosts: ios-rt1
  gather_facts: false
  connection: local
  vars:
    commands: []
    no_commands: []

  tasks:
    - include_vars: main.yml

    - name: Capture show command
      cisco.ios.ios_command:
        commands: "{{ command }}"
      register: _config_asis

    - name: Debug config asis
      debug:
        var: _config_asis.stdout_lines

    - name: Debug config asis
      debug:
        var: config_tobe

    - name: Set variable for policy services / applications
      set_fact:
        commands: "{{ commands + [item] }}"
      loop: "{{ config_tobe }}"
      when: item not in _config_asis.stdout_lines

    - name: Set variable for policy services / applications
      set_fact:
        commands: "{{ no_commands + [item] }}"
      loop: "{{ _config_asis.stdout_lines }}"
      when: item not in config_tobe

    - name: Debug commands
      debug:
        var: _commands

    - name: Debug no commands
      debug:
        var: _no_commands

    #fw_conf_lines: "{{ fw_conf_lines + ['set security policies from-zone ' + _src_zone + ' to-zone ' + _dest_zone + ' policy ' + _rule.name + ' match application ' + srx_services[_service] ] }}"
